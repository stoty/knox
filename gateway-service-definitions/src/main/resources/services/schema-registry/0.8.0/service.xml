<!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<service role="SCHEMA-REGISTRY" name="schema-registry" version="0.8.0">
    <metadata>
        <type>API_AND_UI</type>
        <context>/schema-registry</context>
        <shortDesc>Schema Registry</shortDesc>
        <description>Schema Registry provides a shared repository of schemas that allows applications to flexibly interact with each other.
            Applications built often need a way to share metadata across 3 dimensions: 'Data format', 'Schema' and 'Semantics or meaning of the data'.
            The Schema Registry design principle is to provide a way to tackle the challenges of managing and sharing schemas between components and in 
            such a way that the schemas are designed to support evolution such that a consumer and producer can understand different versions of those schemas 
            but still read all information shared between both versions and safely ignore the rest.</description>
    </metadata>
    <routes>
        <route path="/schema-registry">
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/inbound/root" to="request.url"/>
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/outbound/index" to="response.body"/>
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/outbound/headers" to="response.headers"/>
        </route>
        <route path="/schema-registry/**">
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/inbound/path" to="request.url"/>
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/outbound/index" to="response.body"/>
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/outbound/headers" to="response.headers"/>
        </route>
        <route path="/schema-registry/**?**">
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/inbound/query" to="request.url"/>
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/outbound/index" to="response.body"/>
            <rewrite apply="SCHEMA-REGISTRY/schema-registry/outbound/headers" to="response.headers"/>
        </route>
    </routes>
   <dispatch classname="org.apache.knox.gateway.dispatch.ConfigurableDispatch"
              ha-classname="org.apache.knox.gateway.ha.dispatch.ConfigurableHADispatch">
    </dispatch>
</service>
